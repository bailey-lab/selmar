---
title: "Kelch PfK7 Selection Coefficient Modeling - MANUSCRIPT"
output: html_document
date: "2024-04-17"
---

# This file estimates the selection coefficient using a Bayesian GLM model using
# the K13 allele frequency estimates in SEA

```{r}
library(Matrix)
library(lme4)
library(nlme)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(scales)
library(tidyverse)
library(cowplot)
library(tabulizer)
library(RColorBrewer)
library(tidyverse) # ggplot2, dplyr, tidyr, readr, purrr, tibble
library(rnaturalearth)
library(rnaturalearthdata)
library(sf) #see ubuntu issues here: https://rtask.thinkr.fr/installation-of-r-4-0-on-ubuntu-20-04-lts-and-tips-for-spatial-packages/
library(ggspatial)
library(scatterpie)
library(scales)
library (ggforce)
library (ggmap)
library(rstan)
library(gt)
## install.packages("rstan", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
```

# Allele freq
```{r}
fileLocManuscript_pfK7 <- "figures/"

#load data
pfk7_data_freq <- read.table("data/data-derived/pfk7_data_freq.txt") %>% 
  filter(Locus != "other_K13") 

#set the limit of number of observations
numofobs <- 2

pfk7_data_freq2 <- pfk7_data_freq %>% 
  #filter(!(Locus == "PfK13" & District == "Binh Phuoc" & year == 2005)) %>%
  group_by(Locus, District) 

pfk7_data_freq <- pfk7_data_freq2 %>% 
  group_by(Locus, District) %>%
  filter(nobs > numofobs) %>%
         #min_year <= 2010,
         #year >= min_year & year <= min_year + 4) %>% #filter for the first five year
  arrange(Locus, District, year)
```

## Bayesian GMM with slopes and intercepts
```{r}
source("~/Dropbox (Brown)/Brown/PhD/JeffBaileyLab/Kelch_Uganda_Modeling/selmar/analysis/GLM_model_s_functions.R")
C580Y <- GLM_model_mutant(pfk7_data_freq, "C580Y")
c580y_stanmod <- C580Y$glmer
ranef_c580y_stanmod <- C580Y$ranef

R539T <- GLM_model_mutant(pfk7_data_freq, "R539T")
r539t_stanmod <- R539T$glmer
ranef_r539t_stanmod <- R539T$ranef

K13 <- GLM_model_mutant(pfk7_data_freq, "K13")
K13_stanmod <- K13$glmer
ranef_K13_stanmod <- K13$ranef

ranef_stanmod <- rbind(ranef_c580y_stanmod, ranef_r539t_stanmod, ranef_K13_stanmod)
ranef_stanmod$site <- str_replace_all(rownames(ranef_stanmod), "\\[|\\]", "")
ranef_stanmod$site <- str_replace_all(ranef_stanmod$site, "\\s*\\([^\\)]+\\)", "")
ranef_stanmod$site <- str_remove(ranef_stanmod$site, "b District:")
ranef_stanmod$site <- str_remove(ranef_stanmod$site, "1")

```

## Posterior of the model
```{r}
#  get model predictions for plotting
pfk7_data_freq$predict_stan <- NA

pfk7_data_freq$predict_stan[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "C580Y" & pfk7_data_freq$nobs > numofobs] <-  rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% colMeans
pfk7_data_freq$predict_stan[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "R539T" & pfk7_data_freq$nobs > numofobs] <-  rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% colMeans
pfk7_data_freq$predict_stan[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "K13" & pfk7_data_freq$nobs > numofobs] <-  rstanarm::posterior_predict(K13_stanmod, type = "response") %>% colMeans
```

## Confidence interval
```{r}
#  get model predictions for plotting
pfk7_data_freq$conf.low <- NA
pfk7_data_freq$conf.high <- NA

c580y_conf <- rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
r539t_conf <- rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
K13_conf <- rstanarm::posterior_predict(K13_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))

# here just add predictions  for the c469Y rows
pfk7_data_freq$conf.low[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "C580Y" & pfk7_data_freq$nobs > numofobs] <- c580y_conf[1,]
pfk7_data_freq$conf.low[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "R539T" & pfk7_data_freq$nobs > numofobs] <- r539t_conf[1,]
pfk7_data_freq$conf.low[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "K13" & pfk7_data_freq$nobs > numofobs] <- K13_conf[1,]

pfk7_data_freq$conf.high[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "C580Y" & pfk7_data_freq$nobs > numofobs] <- c580y_conf[2,]
pfk7_data_freq$conf.high[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "R539T" & pfk7_data_freq$nobs > numofobs] <- r539t_conf[2,]
pfk7_data_freq$conf.high[is.finite(pfk7_data_freq$lrsmed) & pfk7_data_freq$Locus == "K13" & pfk7_data_freq$nobs > numofobs] <- K13_conf[2,]
```

## Prevalence scale
```{r}
# Plot the predictions in each site with only Bayesian
#convert to prevalence scale
pfk7_data_freq$predict_stan_prev <- NA

pfk7_data_freq$predict_stan_freq <- exp(pfk7_data_freq$predict_stan)/(1+exp(pfk7_data_freq$predict_stan))
pfk7_data_freq$conf.high_freq <- exp(pfk7_data_freq$conf.high)/(1+exp(pfk7_data_freq$conf.high))
pfk7_data_freq$conf.low_freq <- exp(pfk7_data_freq$conf.low)/(1+exp(pfk7_data_freq$conf.low))
```

## SFigure5: Plot prevalence for all mutations
## Preprocessing
```{r}
prev_df2 <- pfk7_data_freq %>% filter(nobs > numofobs)
prev_df <- rbind(prev_df2, pfk7_data_freq %>% filter(District == "Bago" | District == "Bac Lieu" | District == "Mandalay" | District == "Ninh Thuan")) ## added these sites to show general prevalence across SE Asia
```

## Supplement Plot
```{r}
prev_plot <- prev_df2  %>%
  ggplot(aes(year, freq, group = Locus, color = Locus)) +
  geom_point(aes(size = n/2, group = Locus, color = Locus)) +
  facet_wrap(~country + District) +
  labs(shape="Mutations", size = "Sample Size") +
  theme_bw() +
  geom_line(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(year, predict_stan_freq, color = Locus, group = Locus), size = 1) +
  geom_ribbon(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(ymin = conf.low_freq, ymax = conf.high_freq, color = Locus, fill = Locus), alpha = 0.2,  show.legend = FALSE) +
  scale_color_manual(
    values = c("#56B4E9", "#E69F00", "#009E73"),
    name = "Mutations",
    labels = c("580Y", "K13", "539T")
  ) +
  scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
  ylab("Allele Freq") +
  xlab("Year") +
  #ylim(-0.01, 1.01)+
  ggpubr::theme_pubclean(base_size = 12)+
  scale_x_continuous(breaks = seq(2002, 2020, 4),
                     #limits = c(2002, 2014),
                     minor_breaks = seq(2002, 2020, 2)) +
  theme(
    axis.line = element_line(),
    axis.text = element_text(size = 8),
    axis.title = element_text(size = 12),
    legend.text = element_text(size = 12),
    strip.text.x = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "right",
    legend.box = "vertial"
  )

ggsave(
  paste0(fileLocManuscript_pfK7, "/REVISION/SEAsia_posterior_allele_freq_all.png"),
  prev_plot,
  width = 8,
  height = 8,
  dpi = 700
)
```

# Prevalence with respect to WT
```{r}
fileLocManuscript_pfK7 <- "figures/"

#load data
pfk7_data_prev_WT <- read.table("data/data-derived/pfk7_data_WT.txt") %>% 
  filter(Locus != "other_K13") 

#set the limit of number of observations
numofobs <- 2

pfk7_data_prev_WT2 <- pfk7_data_prev_WT %>% 
  #filter(!(Locus == "PfK13" & District == "Binh Phuoc" & year == 2005)) %>%
  group_by(Locus, District) 

pfk7_data_prev_WT <- pfk7_data_prev_WT2 %>% 
  group_by(Locus, District) %>%
  filter(nobs > numofobs) %>%
         #min_year <= 2010,
         #year >= min_year & year <= min_year + 4) %>% #filter for the first five year
  arrange(Locus, District, year)
```

## Bayesian GMM with slopes and intercepts
```{r}
source("~/Dropbox (Brown)/Brown/PhD/JeffBaileyLab/Kelch_Uganda_Modeling/selmar/analysis/GLM_model_s_functions.R")
C580Y <- GLM_model_mutant(pfk7_data_prev_WT, "C580Y")
c580y_stanmod <- C580Y$glmer
ranef_c580y_stanmod <- C580Y$ranef

R539T <- GLM_model_mutant(pfk7_data_prev_WT, "R539T")
r539t_stanmod <- R539T$glmer
ranef_r539t_stanmod <- R539T$ranef

K13 <- GLM_model_mutant(pfk7_data_prev_WT, "K13")
K13_stanmod <- K13$glmer
ranef_K13_stanmod <- K13$ranef

ranef_stanmod_prev_WT <- rbind(ranef_c580y_stanmod, ranef_r539t_stanmod, ranef_K13_stanmod)
ranef_stanmod_prev_WT$site <- str_replace_all(rownames(ranef_stanmod_prev_WT), "\\[|\\]", "")
ranef_stanmod_prev_WT$site <- str_replace_all(ranef_stanmod_prev_WT$site, "\\s*\\([^\\)]+\\)", "")
ranef_stanmod_prev_WT$site <- str_remove(ranef_stanmod_prev_WT$site, "b District:")
ranef_stanmod_prev_WT$site <- str_remove(ranef_stanmod_prev_WT$site, "1")

```

## Posterior of the model
```{r}
#  get model predictions for plotting
pfk7_data_prev_WT$predict_stan <- NA

pfk7_data_prev_WT$predict_stan[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "C580Y" & pfk7_data_prev_WT$nobs > numofobs] <-  rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% colMeans
pfk7_data_prev_WT$predict_stan[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "R539T" & pfk7_data_prev_WT$nobs > numofobs] <-  rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% colMeans
pfk7_data_prev_WT$predict_stan[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "K13" & pfk7_data_prev_WT$nobs > numofobs] <-  rstanarm::posterior_predict(K13_stanmod, type = "response") %>% colMeans
```

## Confidence interval
```{r}
#  get model predictions for plotting
pfk7_data_prev_WT$conf.low <- NA
pfk7_data_prev_WT$conf.high <- NA

c580y_conf <- rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
r539t_conf <- rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
K13_conf <- rstanarm::posterior_predict(K13_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))

# here just add predictions  for the c469Y rows
pfk7_data_prev_WT$conf.low[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "C580Y" & pfk7_data_prev_WT$nobs > numofobs] <- c580y_conf[1,]
pfk7_data_prev_WT$conf.low[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "R539T" & pfk7_data_prev_WT$nobs > numofobs] <- r539t_conf[1,]
pfk7_data_prev_WT$conf.low[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "K13" & pfk7_data_prev_WT$nobs > numofobs] <- K13_conf[1,]

pfk7_data_prev_WT$conf.high[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "C580Y" & pfk7_data_prev_WT$nobs > numofobs] <- c580y_conf[2,]
pfk7_data_prev_WT$conf.high[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "R539T" & pfk7_data_prev_WT$nobs > numofobs] <- r539t_conf[2,]
pfk7_data_prev_WT$conf.high[is.finite(pfk7_data_prev_WT$lrsmed) & pfk7_data_prev_WT$Locus == "K13" & pfk7_data_prev_WT$nobs > numofobs] <- K13_conf[2,]
```

## Prevalence scale
```{r}
# Plot the predictions in each site with only Bayesian
#convert to prevalence scale
pfk7_data_prev_WT$predict_stan_prev <- NA

pfk7_data_prev_WT$predict_stan_prev <- exp(pfk7_data_prev_WT$predict_stan)/(1+exp(pfk7_data_prev_WT$predict_stan))
pfk7_data_prev_WT$conf.high_prev <- exp(pfk7_data_prev_WT$conf.high)/(1+exp(pfk7_data_prev_WT$conf.high))
pfk7_data_prev_WT$conf.low_prev <- exp(pfk7_data_prev_WT$conf.low)/(1+exp(pfk7_data_prev_WT$conf.low))
```

## SFigure5: Plot prevalence for all mutations
## Preprocessing
```{r}
prev_df2 <- pfk7_data_prev_WT %>% filter(nobs > numofobs)
prev_df <- rbind(prev_df2, pfk7_data_prev_WT %>% filter(District == "Bago" | District == "Bac Lieu" | District == "Mandalay" | District == "Ninh Thuan")) ## added these sites to show general prevalence across SE Asia
```

## Supplement Plot
```{r}
prev_WT_plot <- prev_df2  %>%
  ggplot(aes(year, prev, group = Locus, color = Locus)) +
  geom_point(aes(size = n/2, group = Locus, color = Locus)) +
  facet_wrap(~country + District) +
  labs(shape="Mutations", size = "Sample Size") +
  theme_bw() +
  geom_line(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(year, predict_stan_prev, color = Locus, group = Locus), size = 1) +
  geom_ribbon(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(ymin = conf.low_prev, ymax = conf.high_prev, color = Locus, fill = Locus), alpha = 0.2,  show.legend = FALSE) +
  scale_color_manual(
    values = c("#56B4E9", "#E69F00", "#009E73"),
    name = "Mutations",
    labels = c("580Y", "K13", "539T")
  ) +
  scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
  ylab("Prevalence") +
  xlab("Year") +
  #ylim(-0.01, 1.01)+
  ggpubr::theme_pubclean(base_size = 12)+
  scale_x_continuous(breaks = seq(2002, 2020, 4),
                     #limits = c(2002, 2014),
                     minor_breaks = seq(2002, 2020, 2)) +
  theme(
    axis.line = element_line(),
    axis.text = element_text(size = 8),
    axis.title = element_text(size = 12),
    legend.text = element_text(size = 12),
    strip.text.x = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "right",
    legend.box = "vertial"
  )

ggsave(
  paste0(fileLocManuscript_pfK7, "/REVISION/SEAsia_posterior_prev_WT_all.png"),
  prev_WT_plot,
  width = 8,
  height = 8,
  dpi = 700
)
```

# Prevalence
```{r}
fileLocManuscript_pfK7 <- "figures/"

#load data
pfk7_data_prev <- read.table("data/data-derived/pfk7_data.txt") %>% 
  filter(Locus != "other_K13") 

#set the limit of number of observations
numofobs <- 2

pfk7_data_prev2 <- pfk7_data_prev %>% 
  #filter(!(Locus == "PfK13" & District == "Binh Phuoc" & year == 2005)) %>%
  group_by(Locus, District) 

pfk7_data_prev <- pfk7_data_prev2 %>% 
  group_by(Locus, District) %>%
  filter(nobs > numofobs) %>%
         #min_year <= 2010,
         #year >= min_year & year <= min_year + 4) %>% #filter for the first five year
  arrange(Locus, District, year)
```

## Bayesian GMM with slopes and intercepts
```{r}
source("~/Dropbox (Brown)/Brown/PhD/JeffBaileyLab/Kelch_Uganda_Modeling/selmar/analysis/GLM_model_s_functions.R")
C580Y <- GLM_model_mutant(pfk7_data_prev, "C580Y")
c580y_stanmod <- C580Y$glmer
ranef_c580y_stanmod <- C580Y$ranef

R539T <- GLM_model_mutant(pfk7_data_prev, "R539T")
r539t_stanmod <- R539T$glmer
ranef_r539t_stanmod <- R539T$ranef

K13 <- GLM_model_mutant(pfk7_data_prev, "K13")
K13_stanmod <- K13$glmer
ranef_K13_stanmod <- K13$ranef

ranef_stanmod_prev <- rbind(ranef_c580y_stanmod, ranef_r539t_stanmod, ranef_K13_stanmod)
ranef_stanmod_prev$site <- str_replace_all(rownames(ranef_stanmod_prev), "\\[|\\]", "")
ranef_stanmod_prev$site <- str_replace_all(ranef_stanmod_prev$site, "\\s*\\([^\\)]+\\)", "")
ranef_stanmod_prev$site <- str_remove(ranef_stanmod_prev$site, "b District:")
ranef_stanmod_prev$site <- str_remove(ranef_stanmod_prev$site, "1")

```

## Posterior of the model
```{r}
#  get model predictions for plotting
pfk7_data_prev$predict_stan <- NA

pfk7_data_prev$predict_stan[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "C580Y" & pfk7_data_prev$nobs > numofobs] <-  rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% colMeans
pfk7_data_prev$predict_stan[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "R539T" & pfk7_data_prev$nobs > numofobs] <-  rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% colMeans
pfk7_data_prev$predict_stan[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "K13" & pfk7_data_prev$nobs > numofobs] <-  rstanarm::posterior_predict(K13_stanmod, type = "response") %>% colMeans
```

## Confidence interval
```{r}
#  get model predictions for plotting
pfk7_data_prev$conf.low <- NA
pfk7_data_prev$conf.high <- NA

c580y_conf <- rstanarm::posterior_predict(c580y_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
r539t_conf <- rstanarm::posterior_predict(r539t_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))
K13_conf <- rstanarm::posterior_predict(K13_stanmod, type = "response") %>% apply(2, quantile, prob = (c(0.025, 0.975)))

# here just add predictions  for the c469Y rows
pfk7_data_prev$conf.low[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "C580Y" & pfk7_data_prev$nobs > numofobs] <- c580y_conf[1,]
pfk7_data_prev$conf.low[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "R539T" & pfk7_data_prev$nobs > numofobs] <- r539t_conf[1,]
pfk7_data_prev$conf.low[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "K13" & pfk7_data_prev$nobs > numofobs] <- K13_conf[1,]

pfk7_data_prev$conf.high[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "C580Y" & pfk7_data_prev$nobs > numofobs] <- c580y_conf[2,]
pfk7_data_prev$conf.high[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "R539T" & pfk7_data_prev$nobs > numofobs] <- r539t_conf[2,]
pfk7_data_prev$conf.high[is.finite(pfk7_data_prev$lrsmed) & pfk7_data_prev$Locus == "K13" & pfk7_data_prev$nobs > numofobs] <- K13_conf[2,]
```

## Prevalence scale
```{r}
# Plot the predictions in each site with only Bayesian
#convert to prevalence scale
pfk7_data_prev$predict_stan_prev <- NA

pfk7_data_prev$predict_stan_prev <- exp(pfk7_data_prev$predict_stan)/(1+exp(pfk7_data_prev$predict_stan))
pfk7_data_prev$conf.high_prev <- exp(pfk7_data_prev$conf.high)/(1+exp(pfk7_data_prev$conf.high))
pfk7_data_prev$conf.low_prev <- exp(pfk7_data_prev$conf.low)/(1+exp(pfk7_data_prev$conf.low))
```

## SFigure5: Plot prevalence for all mutations
## Preprocessing
```{r}
prev_df2 <- pfk7_data_prev %>% filter(nobs > numofobs)
prev_df <- rbind(prev_df2, pfk7_data_prev %>% filter(District == "Bago" | District == "Bac Lieu" | District == "Mandalay" | District == "Ninh Thuan")) ## added these sites to show general prevalence across SE Asia
```

## Supplement Plot
```{r}
prev_plot <- prev_df2  %>%
  ggplot(aes(year, prev, group = Locus, color = Locus)) +
  geom_point(aes(size = n/2, group = Locus, color = Locus)) +
  facet_wrap(~country + District) +
  labs(shape="Mutations", size = "Sample Size") +
  theme_bw() +
  geom_line(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(year, predict_stan_prev, color = Locus, group = Locus), size = 1) +
  geom_ribbon(data = prev_df2 %>% filter(nobs > numofobs, is.finite(lrsmed)), aes(ymin = conf.low_prev, ymax = conf.high_prev, color = Locus, fill = Locus), alpha = 0.2,  show.legend = FALSE) +
  scale_color_manual(
    values = c("#56B4E9", "#E69F00", "#009E73"),
    name = "Mutations",
    labels = c("580Y", "K13", "539T")
  ) +
  scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
  ylab("Prevalence") +
  xlab("Year") +
  #ylim(-0.01, 1.01)+
  ggpubr::theme_pubclean(base_size = 12)+
  scale_x_continuous(breaks = seq(2002, 2020, 4),
                     #limits = c(2002, 2014),
                     minor_breaks = seq(2002, 2020, 2)) +
  theme(
    axis.line = element_line(),
    axis.text = element_text(size = 8),
    axis.title = element_text(size = 12),
    legend.text = element_text(size = 12),
    strip.text.x = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "right",
    legend.box = "vertial"
  )

ggsave(
  paste0(fileLocManuscript_pfK7, "/REVISION/SEAsia_posterior_prev_all.png"),
  prev_plot,
  width = 8,
  height = 8,
  dpi = 700
)
```
